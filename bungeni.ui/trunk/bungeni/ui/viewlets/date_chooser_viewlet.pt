<!--script type="text/javascript" src="dhtmlgoodies_calendar/dhtmlgoodies_calendar.js"
           tal:attributes="src context/++resource++dhtmlgoodies_calendar.js" />
<link type="text/css" rel="stylesheet" href="dhtmlgoodies_calendar/dhtmlgoodies_calendar.css" media="screen"
         tal:attributes="href context/++resource++dhtmlgoodies_calendar.css" /--> 
<div tal:attributes="class view/error">
  <form action="@@index" >
    <input name="date" type="text" tal:attributes="value view/DateStr" /> 
    <!--input value="Cal" onclick="displayCalendar(document.forms[0].date,'yyyy-mm-dd',this)" type="button" /-->
    <button type="button" id="select-dates-btn" title="Show Calendar">
       <!--img src="/++resource++calbtn.gif" /-->
    </button>
    
        <script language="javascript">
           YAHOO.util.Event.onDOMReady(function(){
           var dialog, calendar;
           var curdate = "1/1/2008" //<tal:omit-tag tal:replace="view/DateStr" />;
           
           pad = function (value, length) {
              value = String(value);
              length = parseInt(length) || 2;
              while (value.length < length)
                  value = "0" + value;
                  return value;
           };
           
           calendar = new YAHOO.widget.Calendar("select-dates-caldiv", {
                    iframe:false,          // Turn iframe off, since container has iframe support.
                    hide_blank_weeks:true,  // Enable, to demonstrate how we handle changing height, using changeContent
                    mindate:"1/1/2006",
                    maxdate:"12/31/2008",
                    navigator:true
                    });
           
            function handle_cancel() {
                this.hide();
            }

            function handle_ok() {
                if ( calendar.getSelectedDates().length > 0) {
                     var selDate = calendar.getSelectedDates()[0];
                     var datestring = selDate.getFullYear() + "-" + pad( selDate.getMonth()+1, 2) + "-" + pad( selDate.getDate(), 2);
                     document.getElementById("select-dates").value = datestring;
                };
                this.hide();
            }

            dialog = new YAHOO.widget.Dialog("select-dates-container", {
                  context:["select-dates-btn", "tl", "bl"],
                  buttons:[ {text:"Select", isDefault:true, handler: handle_ok },
                            {text:"Cancel", handler: handle_cancel}],
                  width:"16em",  // Sam Skin dialog needs to have a width defined (7*2em + 2*1em = 16em).
                  draggable:false,
                  close:true
                  });        


            // calendar.select( "<tal:omit-tag tal:replace="view/DateStr" />" );
            calendar.render();
            dialog.render();
            
            // Using dialog.hide() instead of visible:false is a workaround for an IE6/7 container known issue with border-collapse:collapse.
            dialog.hide();
            
            calendar.renderEvent.subscribe(function() {
               dialog.fireEvent("changeContent");
               });
            YAHOO.util.Event.on("select-dates-btn", "click", dialog.show, dialog, true);
            });
        </script>

    
    <div id="select-dates-container">
       <div class="hd">Calendar</div>
       <div class="bd">
          <div id="select-dates-caldiv"></div>
       </div>
    </div>

    <input type="submit" value="go" /> 
    <a href="?date=all"> show all </a>
    <div tal:condition="view/error" tal:content="structure view/error_message" />      
  </form>
  
</div>

